@using WebSite.Mvc.Helpers
@model WebSite.ViewModels.Words.WordViewModel

<form class="form-horizontal">
  <div class="modal-header modal-header--custom">
    <button type="button" class="close pull-right" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
    <h2 class="col-md-12 close">@Model.Name</h2>
    <div class="row buttons-header">
      <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 m-b-md">
        <a class="btn btn-default m-r-xs" id="object-edit-btn" data-id="@Model.Id" data-dismiss="modal"><i class="fa fa-pencil"></i></a>
        <a class="btn btn-default m-r-xs" id="object-del" data-id="@Model.Id" data-name="@Model.Name" data-dismiss="modal"><i class="fa fa-trash"></i></a>
      </div>
    </div>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-md-12 col-xs-12">
        <div class="row col-xs-12">
          <table class="table table-striped table-bordered modal-form-table">
            <thead>
              <tr>
                <th class="text-center">Книги</th>
                <th class="text-center">Страницы</th>
                <th class="text-center">Строки</th>
              </tr>
            </thead>
            <tbody>
              @if (Model.WordBooks.Any())
              {
                foreach (var wordbook in Model.WordBooks)
                {
                      <tr>
                        <td class="text-center" rowspan="@(wordbook.Pages.Sum(p=>p.Lines?.Count() + 1) + 1)">
                          @(wordbook.Book?.Name)
                        </td>
                      </tr>
                  if (wordbook.Pages.Any())
                  {
                    foreach (var page in wordbook.Pages)
                    {
                          <tr>
                            <td class="text-center" rowspan="@(page.Lines?.Count() + 1 ?? 1)">
                              @(page.DateRecord.HasValue ? page.DateRecord?.ToString("D") : page.Number + " " + page.Row?.Name)
                            </td>
                          </tr>

                      if (page.Lines?.Any() ?? false)
                      {
                        foreach (var line in page.Lines)
                        {
                                      <tr>
                                        <td class="text-center">
                                          @Html.Raw(line.Up ? "<i class='fa fa-long-arrow-down' />" + line.Number : "<i class='fa fa-long-arrow-up' />" + line.Number)
                                        </td>
                                      </tr>
                        }
                      }
                    }
                  }
                }
              }
              else
              {
                  <tr>
                    <td colspan="3" class="text-center">
                      Записи отсутствуют
                    </td>
                    <td class="hidden"></td>
                    <td class="hidden"></td>
                  </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer no-borders"></div>
</form>
